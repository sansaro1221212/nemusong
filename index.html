<!DOCTYPE html>
<html lang="ja">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ã€éŸ³ä¼½ã­ã‚€ã€‘ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ</title>
  <!-- â˜…â˜…â˜… OGP (Open Graph Protocol) ã‚¿ã‚° (ã“ã“ã‹ã‚‰) â˜…â˜…â˜… -->

  <!-- â‘  ãƒšãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ« -->
  <meta property="og:title" content="ã€éŸ³ä¼½ã­ã‚€ã€‘ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ">
  <!-- ä¾‹: Twitterã‚«ãƒ¼ãƒ‰ã¨åŒã˜ã‹ã€å°‘ã—è©³ç´°ã§ã‚‚è‰¯ã„ -->

  <!-- â‘¡ ãƒšãƒ¼ã‚¸ã®ç¨®é¡ -->
  <meta property="og:type" content="website">
  <!-- ãƒ–ãƒ­ã‚°è¨˜äº‹ãªã‚‰ "article" ãªã© -->

  <!-- â‘¢ ãƒšãƒ¼ã‚¸ã®èª¬æ˜æ–‡ -->
  <meta property="og:description" content="ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ">
  <!-- ä¾‹: Twitterã‚«ãƒ¼ãƒ‰ã®èª¬æ˜æ–‡ã¨åŒã˜ã§è‰¯ã„ã“ã¨ãŒå¤šã„ -->

  <!-- â‘£ ãƒšãƒ¼ã‚¸ã®æ­£è¦URL (é‡è¦ï¼) -->
  <meta property="og:url" content="https://nemusong.netlify.app/">
  <!-- ä¾‹: Netlifyã§å…¬é–‹ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã®æ­£å¼ãªURL -->

  <!-- â‘¤ ã‚µã‚¤ãƒˆå (ä»»æ„) -->
  <meta property="og:site_name" content="ã€éŸ³ä¼½ã­ã‚€ã€‘ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ">
  <!-- ä¾‹: ã‚µã‚¤ãƒˆå…¨ä½“ã®åå‰ -->

  <!-- â‘¥ OGPç”»åƒ (æœ€é‡è¦ï¼) -->
  <!--    æ¨å¥¨ã‚µã‚¤ã‚º: æ¨ª1200px ç¸¦630px (1.91:1) ãŒæœ€ã‚‚æ±ç”¨æ€§ãŒé«˜ã„ -->
  <!--    å½¢å¼: JPG, PNG, GIF -->
  <!--    ç”»åƒã®URLã¯çµ¶å¯¾ãƒ‘ã‚¹ã§æŒ‡å®š -->
  <meta property="og:image" content="https://nemusong.netlify.app/twitter_card_image2.png">
  <!-- ä¾‹: Twitterã‚«ãƒ¼ãƒ‰ã¨åŒã˜ç”»åƒã§ã‚‚è‰¯ã„ã—ã€åˆ¥ã§ã‚‚è‰¯ã„ -->
  <!--     å¯èƒ½ãªã‚‰ HTTPS ã®URLã‚’æŒ‡å®šã™ã‚‹ -->

  <!-- (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ç”»åƒã®å¹…ã¨é«˜ã• (æ¨å¥¨) -->
  <meta property="og:image:width" content="512">
  <meta property="og:image:height" content="385">

  <!-- (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ -->
  <!-- <meta property="og:image:alt" content="ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒšãƒ¼ã‚¸ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒ"> -->

  <!-- (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) Facebookã‚¢ãƒ—ãƒªID (ã‚‚ã—ã‚ã‚Œã°) -->
  <!-- <meta property="fb:app_id" content="YourFacebookAppID"> -->

  <!-- â˜…â˜…â˜… OGP (Open Graph Protocol) ã‚¿ã‚° (ã“ã“ã¾ã§) â˜…â˜…â˜… -->


  <!-- â˜…â˜…â˜… Twitterã‚«ãƒ¼ãƒ‰ç”¨ãƒ¡ã‚¿ã‚¿ã‚° (ã“ã“ã‹ã‚‰) â˜…â˜…â˜… -->
  <meta name="twitter:card" content="summary">
  <!-- <meta name="twitter:site" content="@YourSiteTwitterHandle"> -->
  <!-- <meta name="twitter:creator" content="@CreatorTwitterHandle"> -->
  <meta name="twitter:title" content="ã€éŸ³ä¼½ã­ã‚€ã€‘ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ">
  <meta name="twitter:description" content="ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ">
  <meta name="twitter:image" content="https://nemusong.netlify.app/twitter_card_image.png">
  <!-- â˜… Twitterã‚«ãƒ¼ãƒ‰ç”¨ã®ç”»åƒã¯ og:image ã¨åŒã˜ã§ã‚‚è‰¯ã„ â˜… -->
  <!-- <meta name="twitter:image:alt" content="ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒšãƒ¼ã‚¸ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒ"> -->
  <!-- â˜…â˜…â˜… Twitterã‚«ãƒ¼ãƒ‰ç”¨ãƒ¡ã‚¿ã‚¿ã‚° (ã“ã“ã¾ã§) â˜…â˜…â˜… -->

  <style>
    /* === åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« === */
    body {
      font-family: sans-serif;
      margin: 10px;
      background-color: #f8f9fa;
      font-size: 14px;
      line-height: 1.4;
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
      overflow-x: hidden;
    }
    h1 {
      font-size: 1.3em;
      color: #333;
      margin-bottom: 10px;
    }
    .table-container {
      width: 100%;
      overflow-y: auto;
      max-height: 80vh;
      border: 1px solid #ccc;
      margin-top: 10px;
      background-color: #fff;
    }
    table {
      border-collapse: collapse;
      border-spacing: 0;
      width: 100%;
      table-layout: fixed;
      background-color: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px 8px;
      vertical-align: middle;
      white-space: normal;
      overflow-wrap: break-word;
      word-wrap: break-word;
      background-clip: padding-box;
    }
    th {
      font-weight: bold;
      position: sticky;
      top: 0;
      z-index: 10;
      font-size: 0.9em;
      text-align: center;
      background-color: #e0e0e0;
      color: #333;
      white-space: nowrap;
    }
    #loading, #error, #setlist-loading, #setlist-error, #ranking-loading, #ranking-error {
      margin-top: 20px;
      font-size: 1.1em;
      text-align: center;
    }
    #error, #setlist-error, #ranking-error { color: red; }
    #noDataMessage, #setlist-noData, #ranking-noData {
      display: none;
      text-align: center;
      padding: 20px;
      color: grey;
    }

    /* --- è¦‹å‡ºã—è¡Œã‚¹ã‚¿ã‚¤ãƒ« (ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆç”¨) --- */
    tr.heading-row td {
      font-weight: bold;
      text-align: left !important;
      white-space: normal !important;
      overflow-wrap: break-word;
      word-wrap: break-word;
    }

    /* --- td å†…ã®ãƒªãƒ³ã‚¯ã‚¹ã‚¿ã‚¤ãƒ« --- */
    td a {
      color: #007bff;
      text-decoration: underline;
    }
    #rankingTable td a {
       color: #0056b3;
       text-decoration: none;
    }
     #rankingTable td a:hover {
       text-decoration: underline;
    }

    /* --- äº¤äº’è‰²ã‚¹ã‚¿ã‚¤ãƒ« (ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆç”¨) --- */
    tbody tr.stripe-dodgerblue-odd td { background-color: #D6EBFF; }
    tbody tr.stripe-gold-odd td { background-color: #FFF8DC; }
    tbody tr.stripe-mediumorchid-odd td { background-color: #F5ECFF; }
    tbody tr.stripe-customred-odd td { background-color: #FCE8E8; }
    tbody tr.stripe-skyblue-odd td { background-color: #E0F8FF; }
    tbody tr.stripe-dodgerblue-even td, tbody tr.stripe-gold-even td, tbody tr.stripe-mediumorchid-even td,
    tbody tr.stripe-customred-even td, tbody tr.stripe-skyblue-even td { background-color: #ffffff; }

    /* --- ã€Œåˆã€ãƒãƒ¼ã‚¯ (ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆç”¨) --- */
    td.col-6.first-time { color: #ff0000; text-align: center; }

    /* === åˆ—ã®è¡¨ç¤º/éè¡¨ç¤ºã¨å¹…æŒ‡å®š (ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ç”¨) === */
    .col-0, .col-1, .col-7, .col-10, .col-11, .col-12, .col-13 { display: none !important; }
    .col-2 { width: 2%; text-align: center; white-space: nowrap; } .col-3 { width: 30%; } .col-4 { width: 30%; }
    .col-5 { width: 2%; text-align: center; white-space: nowrap; } .col-6 { width: 2%; text-align: center; white-space: nowrap; }
    .col-8 { width: 25%; } .col-9 { width: 9%; }

    /* === ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« === */
    #ranking-area h2 { font-size: 1.2em; margin-bottom: 10px; color: #333; }
    #ranking-area .table-container { max-height: 75vh; margin-top: 0; }
    #rankingTable th { background-color: #B0C4DE; color: #333; }
    #rankingTable .rank-col { width: 10%; text-align: center; } #rankingTable .title-col { width: 45%; }
    #rankingTable .artist-col { width: 30%; } #rankingTable .count-col { width: 15%; text-align: center; }
    #rankingTable tbody tr:not(.history-detail-row) td { background-color: #E6F0FA; }

    /* å±¥æ­´è©³ç´°è¡Œ */
    .history-detail-row td { background-color: #FFFFFF; padding: 0; border-left: none; border-right: none; vertical-align: top; }
    .history-flex-container { display: flex; flex-wrap: wrap; align-items: center; gap: 3px 6px; padding: 6px 10px; font-size: 0.8em; line-height: 1.3; }
    .history-item { padding: 1px 4px; white-space: nowrap; border-radius: 3px; vertical-align: middle; display: inline-block; }
    .history-item a {
        display: block; text-decoration: none; border: 1px solid transparent; background-color: transparent;
        padding: inherit; margin: -1px -4px; border-radius: inherit; transition: background-color 0.2s ease, border-color 0.2s ease;
        white-space: nowrap;
    }
    .history-item a[style*="background-color"] { border-color: #cce0ff; background-color: #e7f0ff; }
    .history-item a:hover { text-decoration: underline; }
    .history-item a[style*="background-color"]:hover { background-color: #d0e0ff; }
    .history-item:not(:has(a)) { color: #555; }

    /* === ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ãƒœã‚¿ãƒ³ === */
    #mode-selector { margin-bottom: 0px; border-bottom: 1px solid #A9CCE3; padding-bottom: 0; }
    .mode-button {
        padding: 8px 15px; font-size: 1em; cursor: pointer; border: 1px solid #A9CCE3; border-bottom: none;
        background-color: #f0f4f8; color: #337ab7; margin-right: 5px; border-radius: 5px 5px 0 0; outline: none;
        transition: background-color 0.2s ease, color 0.2s ease;
    }
    .mode-button.active { background-color: #D6EBFF; color: #0056b3; font-weight: bold; }
    .mode-button:not(.active):hover { background-color: #e0eaf5; }

    /* === æ¤œç´¢ï¼†å‡¡ä¾‹ã‚¨ãƒªã‚¢ === */
    #search-and-legend-area { margin-bottom: 0px; padding: 10px 0; display: flex; flex-wrap: wrap; align-items: center; gap: 0px 0px; border-bottom: none; } /* borderå‰Šé™¤ */
    #search-controls { flex-grow: 1; display: flex; flex-wrap: wrap; align-items: center; gap: 5px 10px; min-width: 300px; }
    .search-group label { margin-right: 3px; font-weight: normal; font-size: 0.9em; }
    .search-group input[type="text"] { padding: 5px 7px; border: 1px solid #ccc; border-radius: 3px; font-size: 0.95em; }
    #search-controls button { padding: 5px 12px; font-size: 0.95em; cursor: pointer; }
    /* å‡¡ä¾‹ */
    #history-legend { font-size: 0.8em; display: flex; flex-wrap: wrap; gap: 4px 10px; align-items: center; flex-shrink: 0; }
    .legend-item { display: inline-flex; align-items: center; }
    .legend-color-box { display: inline-block; width: 12px; height: 12px; margin-right: 4px; border: 1px solid rgba(0,0,0,0.2); vertical-align: middle; }
    .legend-label { vertical-align: middle; }

  /* === ã‚¹ãƒãƒ›ç”¨ã‚¹ã‚¿ã‚¤ãƒ« (ç”»é¢å¹… 767px ä»¥ä¸‹) === */
  @media screen and (max-width: 767px) {
      body {
        font-size: 11px;
        margin: 5px;
      }
      h1 {
        font-size: 1.1em;
        margin-bottom: 6px;
      }
      th, td {
        padding: 4px 5px;
        vertical-align: top; /* ã‚¹ãƒãƒ›ã§ã¯ä¸Šæƒãˆ */
      }
      th {
        font-size: 1em; /* ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º */
        vertical-align: middle; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã¯ä¸­å¤®æƒãˆ */
      }

      /* â˜… ã‚¹ãƒãƒ›ç”¨ ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆåˆ—å¹… (Jåˆ—éè¡¨ç¤ºã€Iåˆ—éè¡¨ç¤º) â˜… */
      /* è¡¨ç¤º: C(2), D(3), E(4), F(5), G(6) */
      /* åˆè¨ˆ: 10 + 40 + 35 + 7 + 8 = 100% (èª¿æ•´ä¾‹) */
      .col-2 { width: 10%; }
      .col-3 { width: 40%; } /* æ›²ååºƒã‚ */
      .col-4 { width: 35%; } /* ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåã‚‚è¡¨ç¤º */
      .col-5 { width: 7%; }
      .col-6 { width: 8%; }
      .col-8 { width: 0%; display: none; } /* Iåˆ— éè¡¨ç¤º */
      .col-9 { width: 0%; display: none; } /* Jåˆ—(æ—¥ä»˜) éè¡¨ç¤º */

       /* â˜… ã‚¹ãƒãƒ›ç”¨ ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«åˆ—å¹… (ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆè¡¨ç¤ºãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆ) â˜… */
       /* Rank, Title, Artist, Count ã‚’è¡¨ç¤º */
       /* åˆè¨ˆ: 15 + 40 + 25 + 20 = 100% (èª¿æ•´ä¾‹) */
      #rankingTable .rank-col { width: 15%; }
      #rankingTable .title-col { width: 40%; }
      #rankingTable .artist-col {
          width: 25%;             /* å¹…ã‚’è¨­å®š */
          display: table-cell;  /* è¡¨ç¤ºã™ã‚‹ */
          /* font-size ã¨ color ã¯å‰Šé™¤ã—ã€tdã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ç¶™æ‰¿ */
      }
      #rankingTable .count-col { width: 20%; }

      /* ã‚¹ãƒãƒ›ã§ã®å±¥æ­´è©³ç´°è¡Œ */
      .history-flex-container {
          padding: 5px 8px;
          font-size: 0.8em; /* å±¥æ­´æ–‡å­—ã¯å°ã•ã‚ */
          gap: 2px 4px;
          line-height: 1.2;
      }
      .history-item {
          padding: 1px 3px;
      }
       .history-item a {
          margin: -1px -3px;
       }

      /* â˜… ã‚¹ãƒãƒ›ã§ã®æ¤œç´¢ï¼†å‡¡ä¾‹ã‚¨ãƒªã‚¢ â˜… */
      #search-and-legend-area {
          display: block;
          padding: 8px 0 0 0; /* ä¸‹ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°0ç¶­æŒ */
          border-bottom: none; /* ç·šãªã—ç¢ºèª */
          margin-bottom: 5px; /* â˜… ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®ãƒãƒ¼ã‚¸ãƒ³å°‘ã—è©°ã‚ã‚‹ â˜… */
      }
      #search-controls {
          display: block;
          min-width: unset;
      }
      .search-group {
          display: flex;
          align-items: center;
          margin-left: 0 !important;
          gap: 5px;
      }
      #search-controls label {
           display: inline-block;
           width: 90px;          /* â˜… ãƒ©ãƒ™ãƒ«å¹…èª¿æ•´ (å°‘ã—åºƒã’ã‚‹) â˜… */
           text-align: right;    /* â˜… å³æƒãˆ â˜… */
           margin-right: 0;
           flex-shrink: 0;
           font-size: 0.9em;
       }
      #search-controls input[type="text"] {
           width: auto;
           flex-grow: 1;
           box-sizing: border-box;
           padding: 5px 6px;
           font-size: 1em;
           min-width: 100px; /* calc(100% - 100px) ã®æ–¹ãŒè‰¯ã„å ´åˆã‚‚ */
           border: 1px solid #ccc;
           border-radius: 3px;
       }
      #search-controls button { /* ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ */
            display: block;
            width: 100%;
            margin: 8px 0 0 0; /* â˜… ä¸Šãƒãƒ¼ã‚¸ãƒ³å°‘ã—è©°ã‚ã‚‹ â˜… */
            padding: 6px 10px;
            box-sizing: border-box;
       }
       /* â˜… ã‚¹ãƒãƒ›ã§ã®å‡¡ä¾‹ (ä¸Šä¸‹ä½™ç™½å‰Šé™¤) â˜… */
      #history-legend {
          position: static;
          font-size: 0.9em;
          gap: 3px 10px;
          justify-content: center;
          padding: 0;         /* â˜… ä¸Šä¸‹ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‰Šé™¤ â˜… */
          margin-top: 8px;    /* â˜… æ¤œç´¢ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨ã®ä¸Šãƒãƒ¼ã‚¸ãƒ³èª¿æ•´ â˜… */
          border: none;
          background-color: transparent;
          width: 100%;
      }
      .legend-color-box {
          width: 12px;
          height: 12px;
          margin-right: 4px;
      }
      .legend-label { /* ç‰¹ã«æŒ‡å®šãªã— */ }

      /* ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ãƒœã‚¿ãƒ³ */
      .mode-button {
          padding: 6px 10px;
          font-size: 0.9em;
      }
      /* ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¦‹å‡ºã— */
      #ranking-area h2 {
          font-size: 1.1em;
      }
  }
  </style>
  <!-- Tippy.js ã¯ä½¿ç”¨ã—ãªã„ -->
</head>
<body>
  <h1>ã­ã‚€ã®ãŠã†ãŸãƒªã‚¹ãƒˆ</h1>

  <!-- ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ãƒœã‚¿ãƒ³/ã‚¿ãƒ– -->
  <div id="mode-selector">
    <button class="mode-button active" data-mode="setlist">ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆ</button>
    <button class="mode-button" data-mode="ranking">æ­Œå”±å›æ•°ï¼‹æ¤œç´¢</button>
  </div>

  <!-- ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div id="setlist-area">
    <div id="setlist-loading">ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿ä¸­ğŸ—ï¸ğŸ’­...</div>
    <div id="setlist-error" style="display: none;"></div>
    <div id="setlist-noData" style="display: none;">è¡¨ç¤ºã§ãã‚‹ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</div>
    <div class="table-container" id="setlist-table-container">
      <table id="dataTable">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div id="ranking-area" style="display: none;">

    <!-- æ¤œç´¢ï¼†å‡¡ä¾‹ã‚¨ãƒªã‚¢ -->
    <div id="search-and-legend-area" style="display: flex; flex-wrap: wrap; align-items: center;">
        <!-- æ¤œç´¢éƒ¨åˆ† -->
        <div id="search-controls">
              <span class="search-group">
                  <label for="search-title">æ›²å:</label>
                  <input type="text" id="search-title" placeholder="æ›²åã§æ¤œç´¢">
              </span>
              <span class="search-group" style="margin-left: 15px;">
                  <label for="search-artist">ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆå:</label>
                  <input type="text" id="search-artist" placeholder="ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåã§æ¤œç´¢">
              </span>
              <button id="clear-search-button" style="margin-left: 0px;">ã‚¯ãƒªã‚¢</button>
        </div>
        <!-- å‡¡ä¾‹éƒ¨åˆ† -->
        <div id="history-legend">
              <span class="legend-item"> <span class="legend-color-box" style="background-color: #FFF8DC; border-color: #F0E68C;"></span> <span class="legend-label">æ­Œã£ã¦ã¿ãŸ</span> </span>
              <span class="legend-item"> <span class="legend-color-box" style="background-color: #E0F8FF; border-color: #AFEEEE;"></span> <span class="legend-label">æ­Œæ ãƒªãƒ¬ãƒ¼</span> </span>
              <span class="legend-item"> <span class="legend-color-box" style="background-color: #F5ECFF; border-color: #E6E6FA;"></span> <span class="legend-label">è€ä¹…</span> </span>
              <span class="legend-item"> <span class="legend-color-box" style="background-color: #FFE4E1; border-color: #FFC0CB;"></span> <span class="legend-label">3D LIVE</span> </span>
        </div>
    </div>

    <div id="ranking-loading">ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆä¸­ğŸ—ï¸ğŸ’­...</div>
    <div id="ranking-error" style="display: none;"></div>
    <div id="ranking-noData" style="display: none;">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</div>

    <!-- ãƒ†ãƒ¼ãƒ–ãƒ«ã¨å‡¡ä¾‹ã‚’ãƒ©ãƒƒãƒ—ã—ã¦ã„ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã—ã€å‡¡ä¾‹ã¯æ¤œç´¢ã‚¨ãƒªã‚¢ã«ç§»å‹• -->
    <!-- <div id="ranking-content-wrapper" style="position: relative;"> -->
        <!-- å‡¡ä¾‹ã¯ä¸Šã«ç§»å‹• -->
        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«ã‚³ãƒ³ãƒ†ãƒŠ -->
        <div class="table-container" id="ranking-table-container">
          <table id="rankingTable">
            <thead>
              <tr>
                <th class="rank-col">é †ä½</th>
                <th class="title-col">æ›²å</th>
                <th class="artist-col">ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆå</th>
                <th class="count-col">å›æ•°</th>
              </tr>
            </thead>
            <tbody id="rankingTableBody">
              <!-- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯ã“ã“ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
            </tbody>
          </table>
        </div>
    <!-- </div> -->

  </div>

  <script>
    // === è¨­å®šé …ç›® ===
    const defaultFontColorHex = '#000000';

    // --- DOMè¦ç´ å¤‰æ•° ---
    let modeButtons, setlistArea, rankingArea, searchAndLegendArea; // â˜… searchArea -> searchAndLegendArea â˜…
    let setlistTableBody, setlistTableHead, setlistTableContainer, setlistLoadingDiv, setlistErrorDiv, setlistNoDataDiv;
    let rankingTableBody, rankingTableHead, rankingTableContainer, rankingLoadingDiv, rankingErrorDiv, rankingNoDataDiv;
    let searchTitleInput, searchArtistInput, clearSearchButton; // æ¤œç´¢å…¥åŠ›æ¬„
    let historyLegend; // â˜… å‡¡ä¾‹è¦ç´ ã‚‚å–å¾— â˜…

    // --- çŠ¶æ…‹ç®¡ç† ---
    let currentMode = 'setlist';
    let isSetlistLoaded = false;
    let isRankingLoaded = false;
    let originalRankingData = []; // å…ƒã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ

    // --- åˆæœŸå‡¦ç† ---
    document.addEventListener('DOMContentLoaded', function() {
      console.log("DOMContentLoaded: Initializing...");

      // DOMè¦ç´ å–å¾—
      modeButtons = document.querySelectorAll('.mode-button');
      setlistArea = document.getElementById('setlist-area');
      rankingArea = document.getElementById('ranking-area');
      searchAndLegendArea = document.getElementById('search-and-legend-area'); // â˜… IDå¤‰æ›´ â˜…

      // ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆç”¨è¦ç´ 
      setlistTableHead = document.getElementById('dataTable')?.getElementsByTagName('thead')[0];
      setlistTableBody = document.getElementById('dataTable')?.getElementsByTagName('tbody')[0];
      setlistTableContainer = document.getElementById('setlist-table-container');
      setlistLoadingDiv = document.getElementById('setlist-loading');
      setlistErrorDiv = document.getElementById('setlist-error');
      setlistNoDataDiv = document.getElementById('setlist-noData');

      // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”¨è¦ç´ 
      rankingTableHead = document.getElementById('rankingTable')?.getElementsByTagName('thead')[0];
      rankingTableBody = document.getElementById('rankingTableBody') || document.getElementById('rankingTable')?.getElementsByTagName('tbody')[0];
      rankingTableContainer = document.getElementById('ranking-table-container');
      rankingLoadingDiv = document.getElementById('ranking-loading');
      rankingErrorDiv = document.getElementById('ranking-error');
      rankingNoDataDiv = document.getElementById('ranking-noData');
      historyLegend = document.getElementById('history-legend'); // â˜… å‡¡ä¾‹å–å¾— â˜…

      // æ¤œç´¢ç”¨è¦ç´ 
      searchTitleInput = document.getElementById('search-title');
      searchArtistInput = document.getElementById('search-artist');
      clearSearchButton = document.getElementById('clear-search-button');

      // å¿…é ˆè¦ç´ ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
      if (!modeButtons || !setlistArea || !rankingArea || !searchAndLegendArea || // â˜… ãƒã‚§ãƒƒã‚¯å¯¾è±¡å¤‰æ›´ â˜…
          !setlistTableBody || !rankingTableBody || !setlistLoadingDiv || !rankingLoadingDiv ||
          !setlistErrorDiv || !rankingErrorDiv || !searchTitleInput || !searchArtistInput || !clearSearchButton ||
          !setlistTableHead || !setlistTableContainer || !setlistNoDataDiv ||
          !rankingTableHead || !rankingTableContainer || !rankingNoDataDiv || !historyLegend) { // â˜… å‡¡ä¾‹ã‚‚ãƒã‚§ãƒƒã‚¯ â˜…
          console.error("Essential page elements are missing! Initialization aborted.");
          document.body.innerHTML = '<p style="color: red; font-weight: bold; text-align: center; margin-top: 20px;">ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚HTMLæ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>';
          return;
      }

      // åˆæœŸãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ & ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
      if (currentMode === 'setlist') {
        fetchSetlistData();
      }
      setupModeButtons();
      setupSearchInputs();
      setupClearButton();
    });

    // --- ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ãƒœã‚¿ãƒ³ã®è¨­å®š ---
    function setupModeButtons() {
      if (!modeButtons || modeButtons.length === 0) return;
      modeButtons.forEach(button => {
        button.addEventListener('click', () => {
          const mode = button.dataset.mode;
          switchMode(mode);
        });
      });
    }

    // --- æ¤œç´¢å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š ---
    function setupSearchInputs() {
        if (!searchTitleInput || !searchArtistInput) return;
        const filterOnChange = () => {
            if (currentMode === 'ranking') {
                filterAndRedrawRankingTable();
            }
        };
        searchTitleInput.addEventListener('input', filterOnChange);
        searchArtistInput.addEventListener('input', filterOnChange);
    }

    // --- ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š ---
    function setupClearButton() {
        if (!clearSearchButton || !searchTitleInput || !searchArtistInput) return;
        clearSearchButton.addEventListener('click', () => {
            searchTitleInput.value = '';
            searchArtistInput.value = '';
            if (currentMode === 'ranking') {
                filterAndRedrawRankingTable();
            }
        });
    }

    // --- ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆé–¢æ•° ---
    function switchMode(mode) {
      // â˜… searchArea ã‚’å‰Šé™¤ â˜…
      if (mode === currentMode || !setlistArea || !rankingArea || !modeButtons) return;

      console.log(`Switching mode to: ${mode}`);
      currentMode = mode;

      setlistArea.style.display = 'none';
      rankingArea.style.display = 'none'; // æ¤œç´¢ã¨å‡¡ä¾‹ã‚’å«ã‚€
      modeButtons.forEach(btn => btn.classList.remove('active'));

      if (mode === 'setlist') {
        setlistArea.style.display = 'block';
        document.querySelector('.mode-button[data-mode="setlist"]')?.classList.add('active');
        if (!isSetlistLoaded) {
            if (setlistTableBody && setlistLoadingDiv) fetchSetlistData();
            else { console.error("Cannot fetch setlist..."); showErrorMsg('setlist', "ãƒšãƒ¼ã‚¸è¦ç´ ã®å•é¡Œ"); }
        }
      } else if (mode === 'ranking') {
        rankingArea.style.display = 'block';
        document.querySelector('.mode-button[data-mode="ranking"]')?.classList.add('active');
        if (!isRankingLoaded) {
            if (rankingTableBody && rankingLoadingDiv) fetchRankingData();
            else { console.error("Cannot fetch ranking..."); showErrorMsg('ranking', "ãƒšãƒ¼ã‚¸è¦ç´ ã®å•é¡Œ"); }
        } else {
            filterAndRedrawRankingTable();
        }
      }
    }

    // --- ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿å–å¾—ã¨è¡¨ç¤º ---
    async function fetchSetlistData() {
        if (!setlistLoadingDiv || !setlistErrorDiv || !setlistNoDataDiv || !setlistTableHead || !setlistTableBody || !setlistTableContainer) { console.error("Setlist elements missing..."); return; }
        console.log("Fetching setlist data...");
        setlistLoadingDiv.style.display = 'block'; setlistErrorDiv.style.display = 'none'; setlistNoDataDiv.style.display = 'none';
        setlistTableHead.innerHTML = ''; setlistTableBody.innerHTML = ''; setlistTableContainer.style.display = 'block';
        isSetlistLoaded = false;
        const gasApiUrl = "https://script.google.com/macros/s/AKfycby9d_vvcV3LO25LMDKSa4ZZVIYUJxwy6yziHIKDBM26vp_EMfYcs4eS8aE_8DME7_M3/exec";
        if (!gasApiUrl || gasApiUrl.includes("YOUR_GAS_API_URL_HERE")) { showErrorMsg('setlist', "API URL Error"); if(setlistLoadingDiv)setlistLoadingDiv.style.display='none'; return; }
        try {
            const response = await fetch(gasApiUrl);
            if (!response.ok) { let txt = `API Error ${response.status}`; try{txt+=`: ${await response.text()}`}catch(e){} throw new Error(txt); }
            const apiData = await response.json();
            if (apiData.error) { throw new Error(apiData.error); }
            if (apiData && Array.isArray(apiData) && apiData.length > 0 && Array.isArray(apiData[0])) {
                  if (apiData[0].length > 0) { if (apiData.length > 1) { drawSetlistTable(apiData); isSetlistLoaded = true; } else { /* header only */ isSetlistLoaded = true; } }
                  else { /* empty header */ isSetlistLoaded = true; }
            } else { /* no data */ isSetlistLoaded = true; }
            // ãƒ‡ãƒ¼ã‚¿ãªã—ã®å ´åˆã®è¡¨ç¤ºã¯ drawSetlistTable ãªã©ã§è¡Œã†
            if (!isSetlistLoaded) {
                 setlistTableContainer.style.display='none'; setlistNoDataDiv.textContent="è¡¨ç¤ºã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚"; setlistNoDataDiv.style.display='block';
            }
        } catch (error) { showErrorMsg('setlist', `Fetch failed: ${error.message}`); isSetlistLoaded = false; }
        finally { if (setlistLoadingDiv) setlistLoadingDiv.style.display = 'none'; }
    }


    // --- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿å–å¾—ã¨è¡¨ç¤º ---
    async function fetchRankingData() {
        if (!rankingLoadingDiv || !rankingErrorDiv || !rankingNoDataDiv || !rankingTableBody || !rankingTableContainer) { console.error("Ranking elements missing"); return; }
        console.log("Fetching ranking data...");
        rankingLoadingDiv.style.display = 'block'; rankingErrorDiv.style.display = 'none'; rankingNoDataDiv.style.display = 'none';
        rankingTableBody.innerHTML = ''; rankingTableContainer.style.display = 'block';
        isRankingLoaded = false; originalRankingData = [];
        const gasApiUrl = "https://script.google.com/macros/s/AKfycby9d_vvcV3LO25LMDKSa4ZZVIYUJxwy6yziHIKDBM26vp_EMfYcs4eS8aE_8DME7_M3/exec";
        const rankingApiUrl = gasApiUrl + "?mode=ranking";
        if (!gasApiUrl || gasApiUrl.includes("YOUR_GAS_API_URL_HERE")) { showErrorMsg('ranking', "API URL Error"); if(rankingLoadingDiv)rankingLoadingDiv.style.display='none'; return; }
        try {
            const response = await fetch(rankingApiUrl);
            if (!response.ok) { let txt = `Ranking API Error ${response.status}`; try{txt+=`: ${await response.text()}`}catch(e){} throw new Error(txt); }
            const rankingData = await response.json();
            if (rankingData.error) { throw new Error(rankingData.error); }
            if (rankingData && Array.isArray(rankingData)) {
                  originalRankingData = rankingData; filterAndRedrawRankingTable(); isRankingLoaded = true;
            } else { originalRankingData = []; drawRankingTable([]); isRankingLoaded = true; }
        } catch (error) { originalRankingData = []; showErrorMsg('ranking', `Fetch failed: ${error.message}`); isRankingLoaded = false; }
        finally { if (rankingLoadingDiv) rankingLoadingDiv.style.display = 'none'; }
    }

    // --- ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«æç”»é–¢æ•° ---
    function drawSetlistTable(apiData) {
        if (!setlistTableHead || !setlistTableBody) { console.error("Setlist elements missing!"); return; }
        console.log("Drawing setlist table...");
        setlistTableHead.innerHTML = ''; setlistTableBody.innerHTML = '';
        if (!apiData || apiData.length <= 1 || !Array.isArray(apiData[0]) || apiData[0].length === 0) { // ãƒ˜ãƒƒãƒ€ãƒ¼å«ã‚€ãƒ‡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯
            if(setlistTableContainer) setlistTableContainer.style.display='none';
            if(setlistNoDataDiv) { setlistNoDataDiv.textContent="è¡¨ç¤ºã§ãã‚‹ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚"; setlistNoDataDiv.style.display='block'; }
            return;
        }
        if(setlistTableContainer) setlistTableContainer.style.display='block';
        if(setlistNoDataDiv) setlistNoDataDiv.style.display='none';

        const headerRowData = apiData[0]; const headerTr = setlistTableHead.insertRow();
        headerRowData.forEach(cellData => { if (!cellData) return; const th=document.createElement('th'); th.textContent=cellData.value??''; th.className=getColClass(cellData.originalIndex); headerTr.appendChild(th); });
        const dataRows = apiData.slice(1);
        dataRows.forEach(rowData => {
            const tr = setlistTableBody.insertRow(); const isHeadingRow = rowData.some(c=>c&&c.isHeading); if(isHeadingRow) tr.classList.add('heading-row');
            rowData.forEach(cellData => { if (!cellData) return; const td=tr.insertCell(); td.className=getColClass(cellData.originalIndex); if(cellData.colspan>1)td.colSpan=cellData.colspan; if(cellData.linkUrl){const l=document.createElement('a');l.href=cellData.linkUrl;l.textContent=cellData.value??'';l.target="_blank";l.rel="noopener noreferrer";td.appendChild(l);}else{td.textContent=cellData.value??'';} if(cellData.isFirstTime)td.classList.add('first-time'); if(cellData.isBold)td.style.fontWeight='bold';});
        });
        applyHeadingColors(); applyStripeClasses();
    }

    // --- ãƒ©ãƒ³ã‚­ãƒ³ã‚°çµã‚Šè¾¼ã¿ï¼†å†æç”»é–¢æ•° ---
    function filterAndRedrawRankingTable() {
        if (!searchTitleInput || !searchArtistInput || !originalRankingData || !rankingTableBody) { return; }
        const titleKeyword = searchTitleInput.value.toLowerCase().trim();
        const artistKeyword = searchArtistInput.value.toLowerCase().trim();
        const filteredData = originalRankingData.filter(item => {
            const title=(item.title||'').toLowerCase(); const artist=(item.artist||'').toLowerCase();
            const titleMatch=titleKeyword===''||title.includes(titleKeyword); const artistMatch=artistKeyword===''||artist.includes(artistKeyword);
            return titleMatch && artistMatch; // ANDæ¤œç´¢
        });
        drawRankingTable(filteredData);
    }

    // --- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«æç”»é–¢æ•° ---
    function drawRankingTable(rankingData) {
      if (!rankingTableBody) { console.error("Ranking tbody missing!"); return; }
      rankingTableBody.innerHTML = '';
      if (!rankingData || rankingData.length === 0) {
          if(rankingTableContainer) rankingTableContainer.style.display = 'none';
          if(rankingNoDataDiv) { const k1=searchTitleInput?.value.trim()??''; const k2=searchArtistInput?.value.trim()??''; rankingNoDataDiv.textContent=(k1!==''||k2!=='')?`æ¤œç´¢çµæœãªã—`:"ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ãªã—"; rankingNoDataDiv.style.display='block'; } return;
      }
      if(rankingTableContainer) rankingTableContainer.style.display = 'block';
      if(rankingNoDataDiv) rankingNoDataDiv.style.display = 'none';
      const cols = 4;
      const styles={'æ­Œ':{t:'#DAA520',b:'#FFF8DC',d:'#F0E68C'},'ãƒª':{t:'#1E90FF',b:'#E0F8FF',d:'#AFEEEE'},'è€':{t:'#800080',b:'#F5ECFF',d:'#E6E6FA'},'3D':{t:'#DC143C',b:'#FFE4E1',d:'#FFC0CB'}};
      const defLink={t:'#0056b3',b:'#E7F0FF',d:'#cce0ff'}; const defText={t:'#555',b:'transparent',d:'transparent'};

      rankingData.forEach(item => {
          const tr=rankingTableBody.insertRow();
          const rTd=tr.insertCell(); rTd.textContent=item.rank??'-'; rTd.className='rank-col';
          const tTd=tr.insertCell(); tTd.textContent=item.title??'(ä¸æ˜)'; tTd.className='title-col';
          const aTd=tr.insertCell(); aTd.textContent=(item.artist&&item.artist!=="")?item.artist:'-'; aTd.className='artist-col';
          const cTd=tr.insertCell(); cTd.textContent=item.count??'-'; cTd.className='count-col';
          if (item.history?.length > 0) {
              const hTr=rankingTableBody.insertRow(); hTr.className='history-detail-row';
              const hTd=hTr.insertCell(); hTd.colSpan=cols;
              const flex=document.createElement('div'); flex.className='history-flex-container';
              item.history.forEach(h => {
                  const span=document.createElement('span'); span.className='history-item';
                  const date=h.date||'(æ—¥ä»˜ä¸æ˜)'; const type=h.type||'';
                  const style=styles[type]||defLink; const textStyle=defText;
                  let weight=(type==='æ­Œ'||type==='3D')?'bold':'normal';
                  if(h.url){const a=document.createElement('a');a.href=h.url;a.textContent=date;a.target="_blank";a.rel="noopener noreferrer";a.style.color=style.t;a.style.fontWeight=weight;a.style.backgroundColor=style.b;a.style.borderColor=style.d;span.appendChild(a);}
                  else{span.textContent=date; span.style.color=textStyle.t; span.style.fontWeight='normal';}
                  flex.appendChild(span);
              });
              hTd.appendChild(flex);
          }
      });
    }

    // --- ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºé–¢æ•° ---
    function showErrorMsg(mode, message) {
      let errorDiv, loadingDiv, containerDiv, noDataDiv, tableHead, tableBody;
      if(mode==='setlist'){errorDiv=setlistErrorDiv;loadingDiv=setlistLoadingDiv;containerDiv=setlistTableContainer;noDataDiv=setlistNoDataDiv;tableHead=setlistTableHead;tableBody=setlistTableBody;}
      else if(mode==='ranking'){errorDiv=rankingErrorDiv;loadingDiv=rankingLoadingDiv;containerDiv=rankingTableContainer;noDataDiv=rankingNoDataDiv;tableHead=rankingTableHead;tableBody=rankingTableBody;}
      else{console.error("Unknown mode:", mode); return;}
      if(loadingDiv)loadingDiv.style.display='none'; if(containerDiv)containerDiv.style.display='none';
      if(noDataDiv)noDataDiv.style.display='none'; if(tableHead)tableHead.innerHTML=''; if(tableBody)tableBody.innerHTML='';
      if(errorDiv){errorDiv.textContent="ã‚¨ãƒ©ãƒ¼: "+message; errorDiv.style.display='block';}
      else{console.error(`Error div missing: ${mode}`);} console.error(`Error(mode:${mode}):`, message);
    }

    // --- è¦‹å‡ºã—è¡ŒèƒŒæ™¯è‰² (ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆç”¨) ---
    function applyHeadingColors() {
        if(!setlistTableBody)return; const targetTbody=setlistTableBody;
        const headingRows=targetTbody.getElementsByClassName('heading-row');
        const colorMap={'æ­Œ':'#FFD700','ãƒª':'#87CEEB','è€':'#BA55D3','3D':'#E06666'}; const defaultBg='#1E90FF';
        for(let i=0;i<headingRows.length;i++){
            const hr=headingRows[i]; const htd=hr.querySelector('td'); if(!htd)continue;
            const nr=hr.nextElementSibling; let bgColor=defaultBg; htd.style.backgroundColor=bgColor;
            if(nr&&!nr.classList.contains('heading-row')){ const cell=nr.querySelector('td.col-5'); if(cell){ const label=cell.textContent.trim(); const specBg=colorMap[label]; if(specBg){bgColor=specBg;htd.style.backgroundColor=bgColor;}}}
        }
    }

    // --- äº¤äº’è‰² (ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆç”¨) ---
    function applyStripeClasses() {
        if(!setlistTableBody)return; const targetTbody=setlistTableBody;
        const rows=targetTbody.getElementsByTagName('tr'); let idx=0; let prefix='dodgerblue';
        const map={'#FFD700':'gold','#87CEEB':'skyblue','#BA55D3':'mediumorchid','#E06666':'customred','#1E90FF':'dodgerblue'};
        const rgbToHex=(rgb)=>{if(!rgb)return null; if(rgb.startsWith('#'))return rgb.toUpperCase(); const m=rgb.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/); if(!m)return null; return "#"+m.slice(1,4).map(x=>{const h=parseInt(x).toString(16).toUpperCase();return h.length===1?"0"+h:h;}).join('');};
        for(let i=0;i<rows.length;i++){rows[i].className=rows[i].className.replace(/stripe-\w+-(odd|even)/g,'').trim();}
        for(let i=0;i<rows.length;i++){
            const tr=rows[i];
            if(tr.classList.contains('heading-row')||tr.classList.contains('history-detail-row')){
                if(tr.classList.contains('heading-row')){idx=0; const htd=tr.querySelector('td'); if(htd){const bg=window.getComputedStyle(htd).backgroundColor; const hex=rgbToHex(bg); prefix='dodgerblue'; if(hex&&map[hex]){prefix=map[hex];}}}
                continue;
            }
            if(window.getComputedStyle(tr).display!=='none'){const cls=`stripe-${prefix}-${(idx%2===0)?'odd':'even'}`; tr.classList.add(cls); idx++;}
        }
    }

    // --- åˆ—ã‚¯ãƒ©ã‚¹åå–å¾— ---
    function getColClass(i){switch(i){case 0:return 'col-0';case 1:return 'col-1';case 2:return 'col-2';case 3:return 'col-3';case 4:return 'col-4';case 5:return 'col-5';case 6:return 'col-6';case 7:return 'col-7';case 8:return 'col-8';case 9:return 'col-9';case 10:return 'col-10';case 11:return 'col-11';case 12:return 'col-12';case 13:return 'col-13';default:return 'col-other';}}

  </script>
</body>
</html>